---
name: auto-save-before-stop
enabled: true
event: stop
pattern: .*
action: warn
---

## ğŸ›‘ åœæ­¢å‰çš„ä»»åŠ¡æ£€æŸ¥æ¸…å•

åœ¨ç»“æŸ session ä¹‹å‰,è¯·ç¡®ä¿:

### âœ… ä»»åŠ¡çŠ¶æ€ä¿å­˜
- [ ] **æ£€æŸ¥ä»»åŠ¡åˆ—è¡¨**: ä½¿ç”¨ `TaskList` æŸ¥çœ‹æœªå®Œæˆä»»åŠ¡
- [ ] **ä¿å­˜è¿›åº¦**: å°†å½“å‰çŠ¶æ€è®°å½•åˆ° TODO.md æˆ–ä»»åŠ¡æ–‡ä»¶
- [ ] **æ ‡è®°ä»»åŠ¡**: æ›´æ–°æ‰€æœ‰ `in_progress` ä»»åŠ¡çŠ¶æ€

### âœ… ä¸Šä¸‹æ–‡ç®¡ç† (åŸºäº 200K tokens æ ‡å‡†)

**Token é˜ˆå€¼åˆ†çº§è¡ŒåŠ¨**:

| ä½¿ç”¨ç‡ | çº¦ Token æ•° | çº§åˆ« | è¡ŒåŠ¨ |
|--------|-------------|------|------|
| < 85%  | < 170K      | æ­£å¸¸ | ç»§ç»­å·¥ä½œ,å®šæœŸæ£€æŸ¥ |
| 85%    | ~170K       | è­¦å‘Š | å»ºè®®è¿è¡Œ `/compact`,ä¿å­˜å…³é”®ä¿¡æ¯ |
| 90%    | ~180K       | å¼ºçƒˆå»ºè®® | ç«‹å³ `/compact` æˆ–ä¿å­˜è¿›åº¦å‡†å¤‡é‡å¯ |
| 95%    | ~190K       | å¿…é¡»è¡ŒåŠ¨ | ç«‹å³ä¿å­˜æ‰€æœ‰çŠ¶æ€,compact æˆ–é‡å¯ session |

- [ ] **æ£€æŸ¥ä½¿ç”¨ç‡**: è¿è¡Œ `/context` æŸ¥çœ‹å½“å‰ token ä½¿ç”¨æƒ…å†µ
- [ ] **85% (~170K tokens) è­¦å‘Šçº§åˆ«**: ä¿å­˜é‡è¦ä¿¡æ¯åˆ°æ–‡æ¡£,è€ƒè™‘ compact
- [ ] **90% (~180K tokens) å¼ºçƒˆå»ºè®®**: ç«‹å³è¿è¡Œ `/compact` å‹ç¼©å†å²
- [ ] **95% (~190K tokens) å¿…é¡»è¡ŒåŠ¨**: ä¿å­˜æ‰€æœ‰çŠ¶æ€å compact æˆ–é‡å¯ session
- [ ] **ä¿å­˜é‡è¦ä¿¡æ¯**: å°†å…³é”®å†³ç­–/å‘ç°å†™å…¥ MEMORY.md æˆ–é¡¹ç›®æ–‡æ¡£

### âœ… Git çŠ¶æ€
- [ ] **æŸ¥çœ‹æœªæäº¤æ›´æ”¹**: `git status`
- [ ] **æš‚å­˜é‡è¦ä¿®æ”¹**: é¿å…ä¸¢å¤±å·¥ä½œ
- [ ] **è®°å½•æœªå®Œæˆå·¥ä½œ**: æ·»åŠ  TODO æ³¨é‡Š

### ğŸ”„ ç»§ç»­ä»»åŠ¡çš„é€‰é¡¹

**é€‰é¡¹ 1: Compact å¹¶ç»§ç»­**
```
/compact
```
å‹ç¼©å¯¹è¯å†å²,ä¿ç•™å…³é”®ä¿¡æ¯,ç»§ç»­å½“å‰ session

**é€‰é¡¹ 2: ä¿å­˜å¹¶é‡å¯**
1. ä¿å­˜ä»»åŠ¡åˆ—è¡¨åˆ°æ–‡ä»¶
2. ç»“æŸå½“å‰ session
3. æ–° session ä¸­åŠ è½½ä»»åŠ¡ç»§ç»­

**é€‰é¡¹ 3: ç«‹å³ç»§ç»­**
å¦‚æœä»»åŠ¡æ¥è¿‘å®Œæˆ,ç›´æ¥ç»§ç»­å·¥ä½œ

---

ğŸ’¡ **æç¤º**: å®šæœŸä½¿ç”¨ `/compact` å¯ä»¥é¿å…ä¸Šä¸‹æ–‡è¿‡é•¿é—®é¢˜!
