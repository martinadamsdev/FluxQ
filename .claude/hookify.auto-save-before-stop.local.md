---
name: auto-save-before-stop
enabled: true
event: stop
pattern: .*
action: warn
---

## 🛑 停止前的任务检查清单

在结束 session 之前,请确保:

### ✅ 任务状态保存
- [ ] **检查任务列表**: 使用 `TaskList` 查看未完成任务
- [ ] **保存进度**: 将当前状态记录到 TODO.md 或任务文件
- [ ] **标记任务**: 更新所有 `in_progress` 任务状态

### ✅ 上下文管理
- [ ] **检查使用率**: 当前 token 使用情况
- [ ] **考虑 compact**: 如果上下文 > 80%,运行 `/compact` 压缩历史
- [ ] **保存重要信息**: 将关键决策/发现写入文档

### ✅ Git 状态
- [ ] **查看未提交更改**: `git status`
- [ ] **暂存重要修改**: 避免丢失工作
- [ ] **记录未完成工作**: 添加 TODO 注释

### 🔄 继续任务的选项

**选项 1: Compact 并继续**
```
/compact
```
压缩对话历史,保留关键信息,继续当前 session

**选项 2: 保存并重启**
1. 保存任务列表到文件
2. 结束当前 session
3. 新 session 中加载任务继续

**选项 3: 立即继续**
如果任务接近完成,直接继续工作

---

💡 **提示**: 定期使用 `/compact` 可以避免上下文过长问题!
