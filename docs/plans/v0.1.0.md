# v0.1.0 - 项目基础

**目标**: 应用外壳,导航,数据库和核心基础设施。应用可以启动并在标签间导航,数据库就绪。

## 依赖

- Xcode 15+
- macOS 14+ / iOS 17+ SDK

## 任务

### 0.1.1 创建 Xcode 项目

- 创建 SwiftUI 多平台项目 "FluxQ"
- 添加 App targets:
  - FluxQ (macOS/iOS/iPadOS)
  - FluxQWatch (watchOS)
- 配置最低系统版本:
  - macOS 14.0
  - iOS 17.0
  - iPadOS 17.0
  - watchOS 10.0
- 设置 Bundle Identifier: `com.martinadams.FluxQ`

### 0.1.2 配置 SwiftData

- 创建 `FluxQModels` Swift Package
- 定义数据模型:
  ```swift
  @Model final class User {
      @Attribute(.unique) var id: String
      var nickname: String
      var hostname: String
      var ipAddress: String
      var port: Int
      var group: String?
      var status: UserStatus
      var isOnline: Bool
      var lastSeen: Date
  }

  @Model final class Message {
      @Attribute(.unique) var id: String
      var conversationID: String
      var senderID: String
      var content: String
      var timestamp: Date
      var status: MessageStatus
  }

  @Model final class Conversation {
      @Attribute(.unique) var id: String
      var type: ConversationType
      var participantIDs: [String]
      var lastMessageTimestamp: Date
      var unreadCount: Int
  }
  ```
- 配置 ModelContainer:
  ```swift
  @main
  struct FluxQApp: App {
      var body: some Scene {
          WindowGroup {
              ContentView()
          }
          .modelContainer(for: [User.self, Message.self, Conversation.self])
      }
  }
  ```

### 0.1.3 设置项目结构

创建目录结构:
```
FluxQ/
├── App/
│   ├── FluxQ/
│   │   ├── FluxQApp.swift
│   │   ├── Views/
│   │   │   ├── MainTabView.swift
│   │   │   ├── ConversationListView.swift
│   │   │   ├── ContactsView.swift
│   │   │   ├── DiscoveryView.swift
│   │   │   └── SettingsView.swift
│   │   ├── macOS/
│   │   └── iOS/
│   └── FluxQWatch/
│       └── FluxQWatchApp.swift
├── Modules/
│   ├── FluxQModels/
│   ├── IPMsgProtocol/
│   ├── FluxQServices/
│   └── FluxQUI/
└── docs/
```

### 0.1.4 主界面导航

实现 TabView 结构(类似 WeChat):
```swift
struct MainTabView: View {
    var body: some View {
        TabView {
            ConversationListView()
                .tabItem {
                    Label("消息", systemImage: "message.fill")
                }

            ContactsView()
                .tabItem {
                    Label("通讯录", systemImage: "person.2.fill")
                }

            DiscoveryView()
                .tabItem {
                    Label("发现", systemImage: "globe")
                }

            SettingsView()
                .tabItem {
                    Label("我", systemImage: "person.fill")
                }
        }
    }
}
```

每个视图显示占位符内容(空状态)。

### 0.1.5 基础主题系统

- 创建 `FluxQUI` 模块
- 定义主题颜色:
  ```swift
  extension Color {
      static let fluxqGreen = Color(red: 0.0, green: 0.78, blue: 0.33)  // 类似 WeChat 绿
      static let fluxqBubbleMe = Color.fluxqGreen
      static let fluxqBubbleOther = Color(.systemGray5)
  }
  ```
- 支持浅色/深色模式(使用系统 ColorScheme)
- 添加主题切换设置

### 0.1.6 数据模型定义

完善所有 SwiftData 模型:
- `User` - 用户信息
- `Message` - 消息
- `Conversation` - 会话
- `Group` - 群组
- `FileTransfer` - 文件传输记录

添加枚举:
```swift
enum UserStatus: String, Codable {
    case online
    case away
    case busy
    case offline
}

enum MessageStatus: String, Codable {
    case sending
    case sent
    case delivered
    case read
    case failed
}

enum ConversationType: String, Codable {
    case private
    case group
}
```

## 验证

- [ ] 应用在 macOS/iOS/iPadOS 上启动成功
- [ ] TabView 可以切换标签
- [ ] 每个标签显示占位符内容
- [ ] SwiftData ModelContainer 配置正确
- [ ] 数据模型可以创建和保存到数据库
- [ ] 浅色/深色模式切换正常

## 交付物

应用启动,可以在标签间导航,数据库就绪。无网络功能,但核心基础设施完成。
